# UWBæ•°æ®å¡å°”æ›¼æ»¤æ³¢åˆ†æžå·¥å…·

## æ¦‚è¿°

æœ¬å·¥å…·ä¸ºUWBï¼ˆUltra-Widebandï¼‰æµ‹è·æ•°æ®æä¾›äº†å®Œæ•´çš„å¡å°”æ›¼æ»¤æ³¢åˆ†æžåŠŸèƒ½ï¼Œèƒ½å¤Ÿæœ‰æ•ˆå‡å°‘æµ‹é‡å™ªå£°å¹¶æé«˜æ•°æ®è´¨é‡ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ðŸ” å¡å°”æ›¼æ»¤æ³¢ç®—æ³•
- **æ ‡å‡†å¡å°”æ›¼æ»¤æ³¢**ï¼šé€‚ç”¨äºŽä¸€èˆ¬å™ªå£°çŽ¯å¢ƒ
- **è‡ªé€‚åº”æ»¤æ³¢**ï¼šæ ¹æ®æ•°æ®ç‰¹æ€§è‡ªåŠ¨è°ƒæ•´å‚æ•°
- **å¤šæ»¤æ³¢å™¨å¯¹æ¯”**ï¼šåŒæ—¶æµ‹è¯•å¤šç§æ»¤æ³¢å™¨æ•ˆæžœ
- **æœ€ä¼˜é€‰æ‹©**ï¼šè‡ªåŠ¨é€‰æ‹©å™ªå£°å‡å°‘æ•ˆæžœæœ€å¥½çš„æ»¤æ³¢å™¨

### ðŸ“Š æ•°æ®åˆ†æžåŠŸèƒ½
- **å™ªå£°å‡å°‘åˆ†æž**ï¼šè®¡ç®—æ»¤æ³¢å‰åŽçš„å™ªå£°å‡å°‘ç™¾åˆ†æ¯”
- **ç»Ÿè®¡å¯¹æ¯”**ï¼šå¯¹æ¯”åŽŸå§‹æ•°æ®å’Œæ»¤æ³¢åŽæ•°æ®çš„ç»Ÿè®¡ç‰¹æ€§
- **å¯è§†åŒ–åˆ†æž**ï¼šç”Ÿæˆè¯¦ç»†çš„å¯¹æ¯”å›¾è¡¨
- **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒåŒæ—¶å¤„ç†å¤šä¸ªæ•°æ®æ–‡ä»¶

### ðŸ“‹ æŠ¥å‘Šç”Ÿæˆ
- **HTMLç»¼åˆæŠ¥å‘Š**ï¼šåŒ…å«å®Œæ•´çš„åˆ†æžç»“æžœå’Œå¯è§†åŒ–å›¾è¡¨
- **JSONæ•°æ®å¯¼å‡º**ï¼šä¾¿äºŽç¨‹åºåŒ–å¤„ç†å’ŒäºŒæ¬¡å¼€å‘
- **é«˜è´¨é‡å›¾è¡¨**ï¼šPNGæ ¼å¼çš„åˆ†æžå›¾è¡¨

## æ–‡ä»¶ç»“æž„

```
3_Locate/
â”œâ”€â”€ uwb_kalman_analyzer.py          # å¡å°”æ›¼æ»¤æ³¢åˆ†æžå™¨ï¼ˆæŽ¨èä½¿ç”¨ï¼‰
â”œâ”€â”€ kalman_filter.py                # å¡å°”æ›¼æ»¤æ³¢å™¨å®žçŽ°
â”œâ”€â”€ uwb_analyzer_enhanced.py        # å¢žå¼ºç‰ˆåˆ†æžå™¨ï¼ˆåŒ…å«å¡å°”æ›¼æ»¤æ³¢ï¼‰
â”œâ”€â”€ kalman_output/                  # åˆ†æžç»“æžœè¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ kalman_analysis_report.html # HTMLåˆ†æžæŠ¥å‘Š
â”‚   â”œâ”€â”€ kalman_analysis_data.json   # JSONæ•°æ®æ–‡ä»¶
â”‚   â””â”€â”€ kalman_analysis.png         # åˆ†æžå›¾è¡¨
â””â”€â”€ KALMAN_FILTER_README.md         # æœ¬è¯´æ˜Žæ–‡ä»¶
```

## å¿«é€Ÿå¼€å§‹

### 1. çŽ¯å¢ƒè¦æ±‚

```bash
pip install matplotlib numpy
```

### 2. åŸºæœ¬ä½¿ç”¨

```bash
# ä½¿ç”¨å¡å°”æ›¼æ»¤æ³¢åˆ†æžå™¨ï¼ˆæŽ¨èï¼‰
python uwb_kalman_analyzer.py

# ä½¿ç”¨å¢žå¼ºç‰ˆåˆ†æžå™¨ï¼ˆåŒ…å«å¡å°”æ›¼æ»¤æ³¢ï¼‰
python uwb_analyzer_enhanced.py
```

### 3. è¾“å‡ºæ–‡ä»¶

è¿è¡ŒåŽä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

- **kalman_analysis_report.html** - ç»¼åˆHTMLæŠ¥å‘Š
- **kalman_analysis_data.json** - JSONæ ¼å¼æ•°æ®
- **kalman_analysis.png** - å¯è§†åŒ–åˆ†æžå›¾è¡¨

## å¡å°”æ›¼æ»¤æ³¢åŽŸç†

### ç®—æ³•æ¦‚è¿°
å¡å°”æ›¼æ»¤æ³¢æ˜¯ä¸€ç§æœ€ä¼˜ä¼°è®¡ç®—æ³•ï¼Œé€šè¿‡ç»“åˆé¢„æµ‹å’Œè§‚æµ‹ä¿¡æ¯æ¥ä¼°è®¡ç³»ç»ŸçŠ¶æ€ã€‚å¯¹äºŽUWBè·ç¦»æ•°æ®ï¼Œå®ƒèƒ½å¤Ÿï¼š

1. **é¢„æµ‹æ­¥éª¤**ï¼šåŸºäºŽåŽ†å²æ•°æ®é¢„æµ‹å½“å‰çŠ¶æ€
2. **æ›´æ–°æ­¥éª¤**ï¼šç»“åˆæ–°çš„æµ‹é‡æ•°æ®æ›´æ–°ä¼°è®¡
3. **å™ªå£°å‡å°‘**ï¼šæœ‰æ•ˆå‡å°‘æµ‹é‡å™ªå£°çš„å½±å“

### å‚æ•°è¯´æ˜Ž
- **è¿‡ç¨‹å™ªå£° (Q)**ï¼šç³»ç»Ÿæ¨¡åž‹çš„ä¸ç¡®å®šæ€§
- **æµ‹é‡å™ªå£° (R)**ï¼šä¼ æ„Ÿå™¨æµ‹é‡çš„ä¸ç¡®å®šæ€§
- **çŠ¶æ€åæ–¹å·® (P)**ï¼šä¼°è®¡è¯¯å·®çš„åæ–¹å·®

### æ»¤æ³¢å™¨ç±»åž‹
1. **æ ‡å‡†æ»¤æ³¢å™¨**ï¼šé€‚ç”¨äºŽä¸€èˆ¬å™ªå£°çŽ¯å¢ƒ
2. **å¹³æ»‘æ»¤æ³¢å™¨**ï¼šé€‚ç”¨äºŽé«˜å™ªå£°çŽ¯å¢ƒï¼Œæä¾›æ›´å¹³æ»‘çš„ç»“æžœ
3. **å“åº”æ»¤æ³¢å™¨**ï¼šé€‚ç”¨äºŽå¿«é€Ÿå˜åŒ–çš„çŽ¯å¢ƒ
4. **è‡ªé€‚åº”æ»¤æ³¢å™¨**ï¼šæ ¹æ®æ•°æ®ç‰¹æ€§è‡ªåŠ¨è°ƒæ•´å‚æ•°

## åˆ†æžç»“æžœè§£è¯»

### å™ªå£°å‡å°‘ç™¾åˆ†æ¯”
- **> 50%**ï¼šæ»¤æ³¢æ•ˆæžœä¼˜ç§€
- **30-50%**ï¼šæ»¤æ³¢æ•ˆæžœè‰¯å¥½
- **10-30%**ï¼šæ»¤æ³¢æ•ˆæžœä¸€èˆ¬
- **< 10%**ï¼šæ»¤æ³¢æ•ˆæžœæœ‰é™

### ç»Ÿè®¡æŒ‡æ ‡
- **åŽŸå§‹æ ‡å‡†å·®**ï¼šæ»¤æ³¢å‰æ•°æ®çš„ç¦»æ•£ç¨‹åº¦
- **æ»¤æ³¢åŽæ ‡å‡†å·®**ï¼šæ»¤æ³¢åŽæ•°æ®çš„ç¦»æ•£ç¨‹åº¦
- **å‡æ–¹è¯¯å·®**ï¼šæ»¤æ³¢è¯¯å·®çš„é‡åŒ–æŒ‡æ ‡
- **ä¿¡å™ªæ¯”æ”¹å–„**ï¼šä¿¡å·è´¨é‡æ”¹å–„çš„é‡åŒ–æŒ‡æ ‡

## å¯è§†åŒ–å›¾è¡¨è¯´æ˜Ž

### 1. åŽŸå§‹æ•°æ® vs æ»¤æ³¢åŽæ•°æ®å¯¹æ¯”
- è“è‰²çº¿ï¼šåŽŸå§‹æµ‹é‡æ•°æ®
- çº¢è‰²çº¿ï¼šå¡å°”æ›¼æ»¤æ³¢åŽçš„æ•°æ®
- æ˜¾ç¤ºæ»¤æ³¢æ•ˆæžœå’Œè¶‹åŠ¿ä¿æŒæƒ…å†µ

### 2. å™ªå£°å‡å°‘æ•ˆæžœå¯¹æ¯”
- æŸ±çŠ¶å›¾æ˜¾ç¤ºå„æ–‡ä»¶çš„å™ªå£°å‡å°‘ç™¾åˆ†æ¯”
- æ•°å€¼æ ‡ç­¾æ˜¾ç¤ºå…·ä½“çš„å‡å°‘ç™¾åˆ†æ¯”

### 3. æ•°æ®åˆ†å¸ƒå¯¹æ¯”
- ç›´æ–¹å›¾å¯¹æ¯”åŽŸå§‹æ•°æ®å’Œæ»¤æ³¢åŽæ•°æ®çš„åˆ†å¸ƒ
- æ˜¾ç¤ºæ»¤æ³¢å¯¹æ•°æ®åˆ†å¸ƒçš„å½±å“

### 4. æ ‡å‡†å·®å¯¹æ¯”
- å¯¹æ¯”å„æ–‡ä»¶æ»¤æ³¢å‰åŽçš„æ ‡å‡†å·®
- ç›´è§‚æ˜¾ç¤ºå™ªå£°å‡å°‘æ•ˆæžœ

## é«˜çº§ç”¨æ³•

### 1. è‡ªå®šä¹‰æ»¤æ³¢å™¨å‚æ•°

```python
from uwb_kalman_analyzer import UWBKalmanAnalyzer, KalmanFilter

# åˆ›å»ºè‡ªå®šä¹‰æ»¤æ³¢å™¨
kalman = KalmanFilter(
    process_noise=2.0,      # å¢žåŠ è¿‡ç¨‹å™ªå£°
    measurement_noise=30.0   # å‡å°‘æµ‹é‡å™ªå£°
)

# åº”ç”¨è‡ªå®šä¹‰æ»¤æ³¢å™¨
filtered_data = kalman.filter_sequence(your_data)
```

### 2. æ‰¹é‡å¤„ç†å¤šä¸ªç›®å½•

```python
import os
from uwb_kalman_analyzer import UWBKalmanAnalyzer

# æ‰¹é‡å¤„ç†å¤šä¸ªç›®å½•
for directory in ['data1', 'data2', 'data3']:
    analyzer = UWBKalmanAnalyzer()
    analyzer.run_analysis(
        file_pattern=f"{directory}/*.txt",
        output_dir=f"results/{directory}"
    )
```

### 3. ç¨‹åºåŒ–è°ƒç”¨

```python
from uwb_kalman_analyzer import UWBKalmanAnalyzer

# åˆ›å»ºåˆ†æžå™¨
analyzer = UWBKalmanAnalyzer()

# è§£æžæ–‡ä»¶
analyzer.parse_file("your_data.txt")

# åº”ç”¨å¡å°”æ›¼æ»¤æ³¢
kalman_results = analyzer.apply_kalman_filtering()

# èŽ·å–ç»“æžœ
for file_path, result in kalman_results.items():
    print(f"æ–‡ä»¶: {file_path}")
    print(f"å™ªå£°å‡å°‘: {result['statistics']['noise_reduction_percent']:.2f}%")
```

## æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

1. **æ²¡æœ‰æ‰¾åˆ°UWBæ•°æ®åŒ…**
   - æ£€æŸ¥æ•°æ®æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤æ–‡ä»¶åŒ…å«DD 66å¼€å¤´ã€AA BBç»“å°¾çš„æ•°æ®åŒ…

2. **æ»¤æ³¢æ•ˆæžœä¸æ˜Žæ˜¾**
   - å°è¯•è°ƒæ•´æ»¤æ³¢å™¨å‚æ•°
   - æ£€æŸ¥æ•°æ®æ˜¯å¦å·²ç»æ¯”è¾ƒå¹³æ»‘

3. **å›¾è¡¨ç”Ÿæˆå¤±è´¥**
   - ç¡®ä¿å®‰è£…äº†matplotlib
   - æ£€æŸ¥ä¸­æ–‡å­—ä½“æ”¯æŒ

4. **å†…å­˜ä¸è¶³**
   - å‡å°‘åŒæ—¶å¤„ç†çš„æ–‡ä»¶æ•°é‡
   - åˆ†æ‰¹å¤„ç†å¤§é‡æ•°æ®

### è°ƒè¯•æŠ€å·§

```python
# å¯ç”¨è¯¦ç»†è¾“å‡º
analyzer = UWBKalmanAnalyzer()
analyzer.parse_file("your_file.txt")
print(f"æ‰¾åˆ° {len(analyzer.uwb_packets)} ä¸ªæ•°æ®åŒ…")

# æ£€æŸ¥æ•°æ®è´¨é‡
distances = [p.distance for p in analyzer.uwb_packets]
print(f"è·ç¦»èŒƒå›´: {min(distances)} - {max(distances)}")
print(f"æ ‡å‡†å·®: {np.std(distances):.2f}")
```

## æ€§èƒ½ä¼˜åŒ–

### 1. å¤§æ•°æ®é›†å¤„ç†
- ä½¿ç”¨åˆ†æ‰¹å¤„ç†
- è°ƒæ•´æ»¤æ³¢å™¨å‚æ•°ä»¥å‡å°‘è®¡ç®—é‡
- è€ƒè™‘ä½¿ç”¨è‡ªé€‚åº”æ»¤æ³¢å™¨

### 2. å®žæ—¶å¤„ç†
- ä½¿ç”¨å¢žé‡æ›´æ–°ç®—æ³•
- ä¼˜åŒ–æ»¤æ³¢å™¨åˆå§‹åŒ–
- å‡å°‘ä¸å¿…è¦çš„è®¡ç®—

## æ›´æ–°æ—¥å¿—

### v1.0 (å½“å‰ç‰ˆæœ¬)
- âœ… å®žçŽ°æ ‡å‡†å¡å°”æ›¼æ»¤æ³¢å™¨
- âœ… æ”¯æŒå¤šç§æ»¤æ³¢å™¨ç±»åž‹
- âœ… ç”Ÿæˆç»¼åˆHTMLæŠ¥å‘Š
- âœ… æä¾›å¯è§†åŒ–åˆ†æžå›¾è¡¨
- âœ… æ”¯æŒæ‰¹é‡æ–‡ä»¶å¤„ç†
- âœ… JSONæ•°æ®å¯¼å‡ºåŠŸèƒ½

## æŠ€æœ¯ç»†èŠ‚

### å¡å°”æ›¼æ»¤æ³¢æ–¹ç¨‹

**é¢„æµ‹æ­¥éª¤ï¼š**
```
x_k|k-1 = F * x_k-1|k-1
P_k|k-1 = F * P_k-1|k-1 * F^T + Q
```

**æ›´æ–°æ­¥éª¤ï¼š**
```
K_k = P_k|k-1 * H^T / (H * P_k|k-1 * H^T + R)
x_k|k = x_k|k-1 + K_k * (z_k - H * x_k|k-1)
P_k|k = (I - K_k * H) * P_k|k-1
```

å…¶ä¸­ï¼š
- `x`ï¼šçŠ¶æ€ä¼°è®¡
- `P`ï¼šçŠ¶æ€åæ–¹å·®
- `F`ï¼šçŠ¶æ€è½¬ç§»çŸ©é˜µ
- `H`ï¼šè§‚æµ‹çŸ©é˜µ
- `Q`ï¼šè¿‡ç¨‹å™ªå£°åæ–¹å·®
- `R`ï¼šæµ‹é‡å™ªå£°åæ–¹å·®
- `K`ï¼šå¡å°”æ›¼å¢žç›Š
- `z`ï¼šæµ‹é‡å€¼

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- æäº¤ Issue
- å‘é€é‚®ä»¶
- é¡¹ç›®è®¨è®ºåŒº

---

**æ³¨æ„**ï¼šæœ¬å·¥å…·ä¸“ä¸ºUWBå®šä½ç³»ç»Ÿæ•°æ®åˆ†æžè®¾è®¡ï¼Œè¯·æ ¹æ®å®žé™…æ•°æ®æ ¼å¼è°ƒæ•´å‚æ•°ã€‚
